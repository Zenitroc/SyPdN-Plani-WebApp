/*M!999999\- enable the sandbox mode */ 
-- MariaDB dump 10.19  Distrib 10.11.13-MariaDB, for debian-linux-gnu (x86_64)
--
-- Host: localhost    Database: spn
-- ------------------------------------------------------
-- Server version	10.11.13-MariaDB-0ubuntu0.24.04.1

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `assignment_grades`
--

DROP TABLE IF EXISTS `assignment_grades`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8mb4 */;
CREATE TABLE `assignment_grades` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `assignment_id` int(11) NOT NULL,
  `group_id` bigint(20) unsigned NOT NULL,
  `grade_code` varchar(32) DEFAULT NULL,
  `updated_at` datetime NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `ux_ag_unique` (`assignment_id`,`group_id`),
  KEY `ix_ag_assign` (`assignment_id`),
  KEY `ix_ag_group` (`group_id`),
  CONSTRAINT `fk_ag_assign` FOREIGN KEY (`assignment_id`) REFERENCES `assignments` (`id`) ON DELETE CASCADE,
  CONSTRAINT `fk_ag_group` FOREIGN KEY (`group_id`) REFERENCES `groups` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=29 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `assignment_grades`
--

LOCK TABLES `assignment_grades` WRITE;
/*!40000 ALTER TABLE `assignment_grades` DISABLE KEYS */;
/*!40000 ALTER TABLE `assignment_grades` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `assignments`
--

DROP TABLE IF EXISTS `assignments`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8mb4 */;
CREATE TABLE `assignments` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `course_id` bigint(20) unsigned NOT NULL,
  `term` tinyint(4) NOT NULL,
  `type` varchar(8) NOT NULL,
  `number` int(11) NOT NULL,
  `topic` varchar(8) NOT NULL,
  `due_date` date DEFAULT NULL,
  `name` varchar(255) NOT NULL,
  `returned` tinyint(1) NOT NULL DEFAULT 0,
  `created_at` datetime NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `ux_assign_course_term_type_num` (`course_id`,`term`,`type`,`number`),
  KEY `ix_assign_course` (`course_id`),
  CONSTRAINT `fk_assign_course` FOREIGN KEY (`course_id`) REFERENCES `courses` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=15 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `assignments`
--

LOCK TABLES `assignments` WRITE;
/*!40000 ALTER TABLE `assignments` DISABLE KEYS */;
/*!40000 ALTER TABLE `assignments` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `courses`
--

DROP TABLE IF EXISTS `courses`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8mb4 */;
CREATE TABLE `courses` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `code` varchar(32) NOT NULL,
  `name` varchar(120) NOT NULL,
  `color_hex` char(7) DEFAULT NULL,
  `term` varchar(32) DEFAULT NULL,
  `is_active` tinyint(1) NOT NULL DEFAULT 1,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `plan_url` text DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `code` (`code`)
) ENGINE=InnoDB AUTO_INCREMENT=15 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `courses`
--

LOCK TABLES `courses` WRITE;
/*!40000 ALTER TABLE `courses` DISABLE KEYS */;
INSERT INTO `courses` VALUES
(1,'SyPdN-K1030','Lunes','#EED73F','K1030',1,'2025-09-07 02:49:10','2025-09-07 02:52:28',NULL),
(2,'SyPdN-K1027','Martes','#E8ABE6','K1027',1,'2025-09-07 02:49:10','2025-12-29 20:24:57',NULL),
(3,'SyPdN-K1029','Jueves','#1DB8D7','K1029',1,'2025-09-07 02:49:10','2025-09-10 21:30:24',NULL),
(4,'SyPdN-K1028','Viernes 1','#106A1A','K1028',1,'2025-09-06 18:45:03','2025-12-29 20:24:52','https://docs.google.com/spreadsheets/d/e/2PACX-1vSzG6M924tXqHgxD6uVEN6KRCIfSzxw-Dz_1zkA_FpzH0VDmfIQsUflu8ICFzp7wtur-gJX2F6jxyiN/pubhtml?gid=1756005347&single=true'),
(5,'SyPdN-K1022','Viernes 2','#E9A353','K1022',1,'2025-09-06 21:05:33','2025-09-07 02:52:28',NULL);
/*!40000 ALTER TABLE `courses` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `enrollments`
--

DROP TABLE IF EXISTS `enrollments`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8mb4 */;
CREATE TABLE `enrollments` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `course_id` bigint(20) unsigned NOT NULL,
  `person_id` bigint(20) unsigned NOT NULL,
  `course_student_id` int(11) NOT NULL,
  `status` enum('ALTA','BAJA') NOT NULL DEFAULT 'ALTA',
  `group_id` bigint(20) unsigned DEFAULT NULL,
  `observaciones` text DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uniq_course_student` (`course_id`,`course_student_id`),
  UNIQUE KEY `uniq_course_person` (`course_id`,`person_id`),
  KEY `idx_enroll_person` (`person_id`),
  KEY `fk_enroll_group` (`group_id`),
  KEY `idx_enroll_person_status` (`person_id`,`status`),
  CONSTRAINT `fk_enroll_course` FOREIGN KEY (`course_id`) REFERENCES `courses` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `fk_enroll_person` FOREIGN KEY (`person_id`) REFERENCES `people` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=48 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `enrollments`
--

LOCK TABLES `enrollments` WRITE;
/*!40000 ALTER TABLE `enrollments` DISABLE KEYS */;
INSERT INTO `enrollments` VALUES
(29,4,8,1,'ALTA',NULL,''),
(30,4,15,2,'ALTA',NULL,''),
(31,4,12,3,'ALTA',NULL,''),
(32,4,13,4,'ALTA',NULL,''),
(33,4,14,5,'ALTA',NULL,''),
(34,4,16,6,'ALTA',NULL,''),
(35,4,17,7,'ALTA',NULL,''),
(36,4,18,8,'ALTA',NULL,''),
(37,4,19,9,'ALTA',NULL,''),
(38,4,20,10,'ALTA',NULL,''),
(39,4,21,11,'ALTA',NULL,''),
(40,4,22,12,'ALTA',NULL,''),
(41,4,23,13,'ALTA',NULL,''),
(42,4,24,14,'ALTA',NULL,''),
(43,4,25,15,'ALTA',NULL,'sdfsdf'),
(44,4,26,16,'ALTA',NULL,''),
(45,4,27,17,'ALTA',NULL,''),
(46,4,28,18,'ALTA',NULL,''),
(47,4,29,19,'ALTA',NULL,'32323');
/*!40000 ALTER TABLE `enrollments` ENABLE KEYS */;
UNLOCK TABLES;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
/*!50003 CREATE*/ /*!50017 DEFINER=`spn_user`@`localhost`*/ /*!50003 TRIGGER `enroll_group_check_ins` BEFORE INSERT ON `enrollments` FOR EACH ROW BEGIN
  IF NEW.group_id IS NOT NULL AND
     (SELECT g.course_id FROM groups g WHERE g.id = NEW.group_id) <> NEW.course_id THEN
    SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'group_id no pertenece al course_id';
  END IF;
END */;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
/*!50003 CREATE*/ /*!50017 DEFINER=`spn_user`@`localhost`*/ /*!50003 TRIGGER `enroll_unique_active_ins` BEFORE INSERT ON `enrollments` FOR EACH ROW BEGIN
  IF NEW.status = 'ALTA' AND
     EXISTS (
       SELECT 1 FROM enrollments e
       WHERE e.person_id = NEW.person_id
         AND e.status = 'ALTA'
         AND e.course_id <> NEW.course_id
     ) THEN
    SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'La persona ya está ALTA en otro curso';
  END IF;
END */;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
/*!50003 CREATE*/ /*!50017 DEFINER=`spn_user`@`localhost`*/ /*!50003 TRIGGER `enroll_group_check_upd` BEFORE UPDATE ON `enrollments` FOR EACH ROW BEGIN
  IF NEW.group_id IS NOT NULL AND
     (SELECT g.course_id FROM groups g WHERE g.id = NEW.group_id) <> NEW.course_id THEN
    SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'group_id no pertenece al course_id';
  END IF;
END */;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_general_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'NO_AUTO_VALUE_ON_ZERO' */ ;
DELIMITER ;;
/*!50003 CREATE*/ /*!50017 DEFINER=`spn_user`@`localhost`*/ /*!50003 TRIGGER `enroll_unique_active_upd` BEFORE UPDATE ON `enrollments` FOR EACH ROW BEGIN
  IF NEW.status = 'ALTA' AND
     EXISTS (
       SELECT 1 FROM enrollments e
       WHERE e.person_id = NEW.person_id
         AND e.status = 'ALTA'
         AND e.course_id <> NEW.course_id
         AND e.id <> NEW.id
     ) THEN
    SIGNAL SQLSTATE '45000' SET MESSAGE_TEXT = 'La persona ya está ALTA en otro curso';
  END IF;
END */;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;

--
-- Table structure for table `grade_lookup`
--

DROP TABLE IF EXISTS `grade_lookup`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8mb4 */;
CREATE TABLE `grade_lookup` (
  `code` varchar(8) NOT NULL,
  `ordinal` tinyint(4) NOT NULL,
  PRIMARY KEY (`code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `grade_lookup`
--

LOCK TABLES `grade_lookup` WRITE;
/*!40000 ALTER TABLE `grade_lookup` DISABLE KEYS */;
INSERT INTO `grade_lookup` VALUES
('A',0),
('DIST',7),
('DIST-',6),
('NO_SAT',2),
('N_E',1),
('SAT',4),
('SAT+',5),
('SAT-',3);
/*!40000 ALTER TABLE `grade_lookup` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `groups`
--

DROP TABLE IF EXISTS `groups`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8mb4 */;
CREATE TABLE `groups` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `course_id` bigint(20) unsigned NOT NULL,
  `number` int(11) NOT NULL,
  `name` varchar(120) DEFAULT NULL,
  `conformity_submitted` tinyint(1) NOT NULL DEFAULT 0,
  `conformity_url` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uniq_group_per_course` (`course_id`,`number`),
  UNIQUE KEY `uniq_group_course_id` (`course_id`,`id`),
  CONSTRAINT `fk_groups_course` FOREIGN KEY (`course_id`) REFERENCES `courses` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=17 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `groups`
--

LOCK TABLES `groups` WRITE;
/*!40000 ALTER TABLE `groups` DISABLE KEYS */;
/*!40000 ALTER TABLE `groups` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `partial_attendance`
--

DROP TABLE IF EXISTS `partial_attendance`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8mb4 */;
CREATE TABLE `partial_attendance` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `course_id` bigint(20) unsigned NOT NULL,
  `enrollment_id` bigint(20) unsigned NOT NULL,
  `partial_no` tinyint(4) NOT NULL,
  `attempt` enum('PA','1R','2R') NOT NULL,
  `present` tinyint(1) NOT NULL DEFAULT 0,
  `org` tinyint(1) NOT NULL DEFAULT 0,
  `met` tinyint(1) NOT NULL DEFAULT 0,
  `teo1` tinyint(1) NOT NULL DEFAULT 0,
  `pls` tinyint(1) NOT NULL DEFAULT 0,
  `cur` tinyint(1) NOT NULL DEFAULT 0,
  `teo2` tinyint(1) NOT NULL DEFAULT 0,
  `updated_at` datetime NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `ux_pa_unique` (`enrollment_id`,`partial_no`,`attempt`),
  KEY `ix_pa_course` (`course_id`),
  CONSTRAINT `fk_pa_course` FOREIGN KEY (`course_id`) REFERENCES `courses` (`id`) ON DELETE CASCADE,
  CONSTRAINT `fk_pa_enroll` FOREIGN KEY (`enrollment_id`) REFERENCES `enrollments` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=102 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `partial_attendance`
--

LOCK TABLES `partial_attendance` WRITE;
/*!40000 ALTER TABLE `partial_attendance` DISABLE KEYS */;
INSERT INTO `partial_attendance` VALUES
(66,4,29,1,'PA',0,0,0,0,0,0,0,'2026-01-07 16:32:44'),
(71,4,29,2,'PA',0,0,0,0,0,0,0,'2025-12-29 16:34:47');
/*!40000 ALTER TABLE `partial_attendance` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `partial_grades`
--

DROP TABLE IF EXISTS `partial_grades`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8mb4 */;
CREATE TABLE `partial_grades` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `course_id` bigint(20) unsigned NOT NULL,
  `enrollment_id` bigint(20) unsigned NOT NULL,
  `partial_no` tinyint(4) NOT NULL,
  `topic` varchar(8) NOT NULL,
  `attempt` enum('PA','1R','2R') NOT NULL,
  `grade_code` varchar(32) DEFAULT NULL,
  `updated_at` datetime NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `ux_pg_unique` (`enrollment_id`,`partial_no`,`topic`,`attempt`),
  KEY `ix_pg_course` (`course_id`),
  CONSTRAINT `fk_pg_course` FOREIGN KEY (`course_id`) REFERENCES `courses` (`id`) ON DELETE CASCADE,
  CONSTRAINT `fk_pg_enroll` FOREIGN KEY (`enrollment_id`) REFERENCES `enrollments` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=130 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `partial_grades`
--

LOCK TABLES `partial_grades` WRITE;
/*!40000 ALTER TABLE `partial_grades` DISABLE KEYS */;
INSERT INTO `partial_grades` VALUES
(127,4,29,1,'ORG','PA',NULL,'2026-01-07 15:44:39');
/*!40000 ALTER TABLE `partial_grades` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `people`
--

DROP TABLE IF EXISTS `people`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8mb4 */;
CREATE TABLE `people` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `last_name` varchar(80) NOT NULL,
  `first_name` varchar(80) NOT NULL,
  `legajo` varchar(10) NOT NULL,
  `email_inst` varchar(190) DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  PRIMARY KEY (`id`),
  UNIQUE KEY `uniq_people_legajo` (`legajo`),
  UNIQUE KEY `uniq_people_email` (`email_inst`)
) ENGINE=InnoDB AUTO_INCREMENT=30 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `people`
--

LOCK TABLES `people` WRITE;
/*!40000 ALTER TABLE `people` DISABLE KEYS */;
INSERT INTO `people` VALUES
(8,'Cortinez','Franco Matias','1762060','fcortnez@frba.utn.edu.ar','2025-09-07 03:11:50'),
(9,'Berro','Camila Andrea','1723418','cberro@frba.utn.edu.ar','2025-09-07 19:35:53'),
(10,'eeeee','eeeee','12312312','eeeee','2025-09-09 01:42:42'),
(11,'apellido','nombre','legajo','email_inst','2025-09-09 01:50:04'),
(12,'aaaaa','aaaaa','12345','aaaa','2025-09-09 01:50:04'),
(13,'bbbb','bbbb','12313','bbbbb','2025-09-09 01:50:04'),
(14,'ccccc','cccccc ccc','34234','cccc','2025-09-09 01:50:04'),
(15,'berro','camila','1721211','a?dka?dka?','2025-12-30 00:13:04'),
(16,'dddd','ddd','4','ddde','2025-12-30 00:13:04'),
(17,'eeeee','eeee','5','eee','2025-12-30 00:13:04'),
(18,'fff','ffff','6','fff','2025-12-30 00:13:04'),
(19,'ggg','ggg','7','gg','2025-12-30 00:13:04'),
(20,'hhhh','hhhh','8','hhhh','2025-12-30 00:13:04'),
(21,'ad','aaaaa','9','ad','2025-12-30 00:13:04'),
(22,'asdasd','bbbbb','10','asdas','2025-12-30 00:13:04'),
(23,'sdas','cccc','11','dasdasdas','2025-12-30 00:13:04'),
(24,'asdasd','hhhh','16','asdasdas','2025-12-30 00:13:04'),
(25,'sfsdf','sdfsdfsd','sdfsdfsd','sdfsdfsd','2026-01-07 16:23:55'),
(26,'sdfsfsdfsdfsdf','sdfsdfsdfsdfsdfs','1312313131','dfsdfsdfsdfsdf','2026-01-07 16:24:33'),
(27,'1231231231231','231231231231','123131313','2313123123','2026-01-07 16:24:45'),
(28,'12313131','123123123','3232323','32323232','2026-01-07 16:24:55'),
(29,'23232323','2323232','32323','2323232','2026-01-07 16:25:04');
/*!40000 ALTER TABLE `people` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `planning`
--

DROP TABLE IF EXISTS `planning`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8mb4 */;
CREATE TABLE `planning` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `course_id` bigint(20) unsigned NOT NULL,
  `class_no` int(11) NOT NULL,
  `date` date NOT NULL,
  `mod1_teorico` varchar(255) DEFAULT NULL,
  `mod2_practico` varchar(255) DEFAULT NULL,
  `tarea_proxima` varchar(255) DEFAULT NULL,
  `entrega_hoy` varchar(255) DEFAULT NULL,
  `observaciones` text DEFAULT NULL,
  `estado` enum('PLANEADA','EN_CURSO','DICTADA','CANCELADA') NOT NULL DEFAULT 'PLANEADA',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uniq_planning_class` (`course_id`,`class_no`),
  KEY `idx_planning_date` (`course_id`,`date`),
  CONSTRAINT `fk_planning_course` FOREIGN KEY (`course_id`) REFERENCES `courses` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `planning`
--

LOCK TABLES `planning` WRITE;
/*!40000 ALTER TABLE `planning` DISABLE KEYS */;
/*!40000 ALTER TABLE `planning` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `roles`
--

DROP TABLE IF EXISTS `roles`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8mb4 */;
CREATE TABLE `roles` (
  `id` tinyint(3) unsigned NOT NULL AUTO_INCREMENT,
  `code` varchar(16) NOT NULL,
  `description` varchar(120) DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `code` (`code`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `roles`
--

LOCK TABLES `roles` WRITE;
/*!40000 ALTER TABLE `roles` DISABLE KEYS */;
INSERT INTO `roles` VALUES
(1,'GURU','Administrador funcional total'),
(2,'SENIOR','Operaciones avanzadas'),
(3,'AYUDANTE','Operaciones acotadas');
/*!40000 ALTER TABLE `roles` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `user_courses`
--

DROP TABLE IF EXISTS `user_courses`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8mb4 */;
CREATE TABLE `user_courses` (
  `user_id` bigint(20) unsigned NOT NULL,
  `course_id` bigint(20) unsigned NOT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  PRIMARY KEY (`user_id`,`course_id`),
  KEY `fk_user_courses_course` (`course_id`),
  CONSTRAINT `fk_user_courses_course` FOREIGN KEY (`course_id`) REFERENCES `courses` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `fk_user_courses_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `user_courses`
--

LOCK TABLES `user_courses` WRITE;
/*!40000 ALTER TABLE `user_courses` DISABLE KEYS */;
INSERT INTO `user_courses` VALUES
(1,1,'2025-12-29 20:31:12'),
(1,3,'2025-12-29 20:52:01'),
(1,4,'2025-09-06 18:46:27'),
(5,4,'2026-01-04 21:56:12');
/*!40000 ALTER TABLE `user_courses` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `user_roles`
--

DROP TABLE IF EXISTS `user_roles`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8mb4 */;
CREATE TABLE `user_roles` (
  `user_id` bigint(20) unsigned NOT NULL,
  `role_id` tinyint(3) unsigned NOT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  PRIMARY KEY (`user_id`,`role_id`),
  KEY `fk_user_roles_role` (`role_id`),
  CONSTRAINT `fk_user_roles_role` FOREIGN KEY (`role_id`) REFERENCES `roles` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `fk_user_roles_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `user_roles`
--

LOCK TABLES `user_roles` WRITE;
/*!40000 ALTER TABLE `user_roles` DISABLE KEYS */;
INSERT INTO `user_roles` VALUES
(1,1,'2025-12-29 23:17:30'),
(5,3,'2026-01-04 21:54:18');
/*!40000 ALTER TABLE `user_roles` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `users`
--

DROP TABLE IF EXISTS `users`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8mb4 */;
CREATE TABLE `users` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(120) NOT NULL,
  `last_name` varchar(120) DEFAULT NULL,
  `email` varchar(190) NOT NULL,
  `personal_email` varchar(190) DEFAULT NULL,
  `legajo` varchar(60) DEFAULT NULL,
  `phone` varchar(60) DEFAULT NULL,
  `photo_data` longtext DEFAULT NULL,
  `photo_mime` varchar(120) DEFAULT NULL,
  `password_hash` varchar(255) NOT NULL,
  `must_change_password` tinyint(1) NOT NULL DEFAULT 0,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `username` varchar(255) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `email` (`email`),
  UNIQUE KEY `username` (`username`)
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `users`
--

LOCK TABLES `users` WRITE;
/*!40000 ALTER TABLE `users` DISABLE KEYS */;
INSERT INTO `users` VALUES
(1,'Gurú','admin','guru@example.com',NULL,'22222222','11111111111',... Aca borro xq habia una foto y era mucho textoooo
(5,'ayudante','ayudante','ayudante@ayudante.com',NULL,'123123',NULL,NULL,NULL,'$2y$10$dtx3VFj6Ovz/qst5EF8Mo.1rRsRrsnsWxHfsNFjvSHg09.zKamupS',0,'2026-01-04 21:54:18','ayudante');
/*!40000 ALTER TABLE `users` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Dumping events for database 'spn'
--

--
-- Dumping routines for database 'spn'
--
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2026-01-07 17:47:06

--
-- Indices de la tabla `reportes_resources`
--
ALTER TABLE `reportes_resources`
  ADD PRIMARY KEY (`id`);

--
-- Indices de la tabla `reportes_news`
--
ALTER TABLE `reportes_news`
  ADD PRIMARY KEY (`id`);


-- AUTO_INCREMENT de la tabla `reportes_resources`
--
ALTER TABLE `reportes_resources`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT de la tabla `reportes_news`
--
ALTER TABLE `reportes_news`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- Estructura de tabla para la tabla `reportes_resources`
--

CREATE TABLE `reportes_resources` (
  `id` int(11) NOT NULL,
  `title` varchar(180) NOT NULL,
  `description` text DEFAULT NULL,
  `url` text NOT NULL,
  `icon_emoji` varchar(16) DEFAULT NULL,
  `icon_image` text DEFAULT NULL,
  `created_by` int(11) DEFAULT NULL,
  `updated_by` int(11) DEFAULT NULL,
  `created_at` datetime NOT NULL DEFAULT current_timestamp(),
  `updated_at` datetime NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Estructura de tabla para la tabla `reportes_news`
--

CREATE TABLE `reportes_news` (
  `id` int(11) NOT NULL,
  `title` varchar(180) NOT NULL,
  `preview` text DEFAULT NULL,
  `body` text DEFAULT NULL,
  `link` text DEFAULT NULL,
  `link_label` varchar(120) DEFAULT NULL,
  `image` text DEFAULT NULL,
  `created_by` int(11) DEFAULT NULL,
  `updated_by` int(11) DEFAULT NULL,
  `created_at` datetime NOT NULL DEFAULT current_timestamp(),
  `updated_at` datetime NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
