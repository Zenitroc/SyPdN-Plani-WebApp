<!doctype html>
<html lang="es">

<head>
  <meta charset="utf-8" />
  <title>Home — SyPdN</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400..800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../../public/assets/css/base.css">
  <style>
    .row{display:flex;gap:.6rem;align-items:center}
    .row-between{display:flex;gap:.6rem;align-items:center;justify-content:space-between;flex-wrap:wrap}
    .pill{display:inline-flex;align-items:center;gap:.35rem;padding:.2rem .6rem;border-radius:999px;border:1px solid var(--border);font-size:.85rem}
    .user-card{border:1px solid var(--border);border-radius:var(--radius);padding:.75rem;background:color-mix(in oklab, var(--surface) 90%, var(--bg))}
    .user-card.active{border-color:color-mix(in oklab, var(--primary) 45%, var(--border));background:color-mix(in oklab, var(--primary) 10%, var(--surface))}
    .user-avatar{width:46px;height:46px;border-radius:50%;object-fit:cover;border:1px solid var(--border)}
    .user-avatar.fallback{display:flex;align-items:center;justify-content:center;font-size:.9rem;font-weight:700;background:color-mix(in oklab, var(--surface) 80%, var(--bg))}
  </style>
</head>

<body>
  <nav id="appMenu"></nav>

  <main class="container" id="main">
    <h1 style="display:none">Home</h1>


    <!-- Barra curso seleccionado -->
    <section id="selectedCourse" class="card" style="display:none;margin-top:1rem"></section>
    <section id="kpis" style="margin-top:1rem"></section>
    <!-- Grid de comisiones (cards) -->
    <section id="courseBox" class="card" style="display:none;margin-top:1rem">
      <div class="row" style="justify-content:space-between;flex-wrap:wrap;gap:.5rem">
        <div>
          <div class="label">Tus comisiones</div>
          <small class="hint">Elegí la comisión que querés gestionar.</small>
        </div>
        <div class="row" style="gap:.4rem">
          <input id="searchInput" class="input" placeholder="Buscar comisión / año / cuatri" style="min-width:220px">
        </div>
      </div>
      <div id="courseGrid" style="display:flex;gap:.75rem;flex-wrap:wrap;margin-top:.75rem"></div>
    </section>

    <section id="userManager" class="card" style="display:none;margin-top:1rem">
      <div class="row-between">
        <div>
          <div class="label">Gestor de usuarios</div>
          <small class="hint">Administrá usuarios, roles y cursos asignados.</small>
        </div>
        <div class="row" style="gap:.5rem">
          <input id="userSearch" class="input" placeholder="Buscar por nombre, usuario o email" style="min-width:240px">
          <button id="btnToggleCreate" class="btn btn-primary">+ Nuevo usuario</button>
        </div>
      </div>

      <div id="userCreatePanel" class="card" style="margin-top:1rem;display:none">
        <h3 style="margin-top:0">Alta de usuario</h3>
        <div class="grid cols-3">
          <label class="label">Nombre
            <input id="newUserName" class="input" type="text" placeholder="Nombre" />
          </label>
          <label class="label">Apellido
            <input id="newUserLastName" class="input" type="text" placeholder="Apellido" />
          </label>
          <label class="label">Usuario
            <input id="newUserUsername" class="input" type="text" placeholder="usuario" />
          </label>
          <label class="label">Email institucional
            <input id="newUserEmail" class="input" type="email" placeholder="usuario@institucion.edu" />
          </label>
          <label class="label">Email personal (opcional)
            <input id="newUserPersonalEmail" class="input" type="email" placeholder="usuario@gmail.com" />
          </label>
          <label class="label">Legajo
            <input id="newUserLegajo" class="input" type="text" placeholder="Legajo" />
          </label>
          <label class="label">Teléfono (opcional)
            <input id="newUserPhone" class="input" type="text" placeholder="+54 11 ..." />
          </label>
          <label class="label">Foto (opcional)
            <input id="newUserPhoto" class="input" type="file" accept="image/*" />
            <small class="hint">Máximo 200KB.</small>
          </label>
        </div>
        <div class="label" style="margin-top:1rem">Roles</div>
        <div id="newUserRoles" class="row" style="flex-wrap:wrap;gap:.5rem"></div>
        <div class="row" style="margin-top:1rem;justify-content:flex-end;gap:.5rem">
          <button id="btnCancelCreate" class="btn btn-ghost">Cancelar</button>
          <button id="btnCreateUser" class="btn btn-primary">Crear usuario</button>
        </div>
        <div id="createUserMsg" class="muted" style="margin-top:.5rem"></div>
      </div>

      <div class="grid cols-2" style="margin-top:1rem">
        <div>
          <div id="userList" class="grid" style="gap:.75rem"></div>
        </div>
        <div>
          <div id="userDetail" class="card" style="min-height:200px">
            <div class="muted">Seleccioná un usuario para ver el detalle.</div>
          </div>
        </div>
      </div>
    </section>
   
  </main>


  </div>

  
  <script>
    (function () {
      if (!('serviceWorker' in navigator)) return;

      // Detecta BASE_APP sin depender de variables globales
      const parts = location.pathname.split('/').filter(Boolean);
      const i = parts.indexOf('public');
      const BASE_APP = i > 0 ? '/' + parts.slice(0, i).join('/') : '';

      navigator.serviceWorker.register(BASE_APP + '/public/sw.js')
        .then(r => console.log('[SW] registrado en', r.scope))
        .catch(err => console.warn('[SW] error', err));
    })();
  </script>


  <script src="../../../public/assets/js/api.js"></script>
  <script src="../../../public/assets/js/theme.js"></script>
  <script src="../../../public/assets/js/course-context.js"></script>
  <script src="../../../public/assets/js/menu.js"></script>
  <script src="./home.js"></script>
</body>

</html>